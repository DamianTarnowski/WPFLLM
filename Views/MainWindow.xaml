<Window x:Class="WPFLLM.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:WPFLLM.Views"
        xmlns:vm="clr-namespace:WPFLLM.ViewModels"
        Title="WPFLLM - AI Assistant" 
        Height="800" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Background="{StaticResource BackgroundBrush}">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TabControl Style="{StaticResource ModernTabControl}"
                    SelectedIndex="{Binding SelectedTabIndex}">
            <TabControl.ItemContainerStyle>
                <Style TargetType="TabItem" BasedOn="{StaticResource ModernTabItem}"/>
            </TabControl.ItemContainerStyle>

            <TabItem Header="{DynamicResource Nav_Chat}">
                <views:ChatView DataContext="{Binding ChatViewModel}"/>
            </TabItem>

            <TabItem Header="{DynamicResource Nav_KnowledgeBase}">
                <views:RagView DataContext="{Binding RagViewModel}"/>
            </TabItem>

            <TabItem Header="{DynamicResource Nav_DocumentAnalysis}">
                <views:DocumentAnalysisView DataContext="{Binding DocumentAnalysisViewModel}"/>
            </TabItem>

            <TabItem Header="{DynamicResource Nav_Embeddings}">
                <views:EmbeddingsView DataContext="{Binding EmbeddingsViewModel}"/>
            </TabItem>

            <TabItem Header="{DynamicResource Nav_Settings}">
                <views:SettingsView DataContext="{Binding SettingsViewModel}"/>
            </TabItem>

            <TabItem Header="{DynamicResource Nav_Help}">
                <views:HelpView/>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <Border Grid.Row="1" 
                Background="{StaticResource SurfaceBrush}"
                Padding="12,6"
                BorderThickness="0,1,0,0"
                BorderBrush="{StaticResource SurfaceLightBrush}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="{Binding StatusText}" 
                           Foreground="{StaticResource TextMutedBrush}"
                           FontSize="11"
                           VerticalAlignment="Center"/>

                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <!-- Offline Mode Indicator -->
                    <Border CornerRadius="4" Padding="8,3" Margin="0,0,8,0">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="#22C55E"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsOfflineMode}" Value="False">
                                        <Setter Property="Background" Value="#3B82F6"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock FontSize="11" Foreground="White" VerticalAlignment="Center">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Text" Value="ðŸ”’ Offline"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsOfflineMode}" Value="False">
                                                <Setter Property="Text" Value="ðŸŒ Online"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </StackPanel>
                    </Border>

                    <!-- Encryption Indicator -->
                    <Border CornerRadius="4" Padding="8,3" Margin="0,0,8,0">
                        <Border.Style>
                            <Style TargetType="Border">
                                <Setter Property="Background" Value="{StaticResource SurfaceLightBrush}"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsEncrypted}" Value="True">
                                        <Setter Property="Background" Value="#22C55E"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Border.Style>
                        <TextBlock FontSize="11" VerticalAlignment="Center">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Setter Property="Foreground" Value="{StaticResource TextMutedBrush}"/>
                                    <Setter Property="Text" Value="ðŸ”“ Not Encrypted"/>
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding IsEncrypted}" Value="True">
                                            <Setter Property="Foreground" Value="White"/>
                                            <Setter Property="Text" Value="ðŸ” Encrypted"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </Border>

                    <!-- Network Calls Counter -->
                    <Border Background="{StaticResource SurfaceLightBrush}" CornerRadius="4" Padding="8,3">
                        <TextBlock Foreground="{StaticResource TextMutedBrush}" FontSize="11" VerticalAlignment="Center">
                            <Run Text="ðŸ“¡ "/>
                            <Run Text="{DynamicResource Status_NetworkCalls}"/>
                            <Run Text=": "/>
                            <Run Text="{Binding NetworkCallCount, Mode=OneWay}"/>
                        </TextBlock>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>
